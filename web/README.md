# Coffee Editor Extension Example
An example of how to build the Theia-based applications with the tree-editor-extension.

## Used Projects
We are relying on a bunch of projects:
* https://github.com/eclipsesource/theia-tree-editor
* https://github.com/eclipsesource/jsonforms
* https://github.com/eclipsesource/graphical-lsp

If you encounter issues please report them in the corresponding project.
This project should not contain much code and should mostly consist of 'glue' code to combine the different components.

## Prerequisites

Install [nvm](https://github.com/creationix/nvm#install-script).

    curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.5/install.sh | bash

Install npm and node.

    nvm install 8
    nvm use 8

Install yarn.

    npm install -g yarn

## Setting the graphical server language protocol

This step is required to get the workflow graphical editor running (empty editor without the server started). The server should be automatically started when the editor is opened.

### compiling the GLSP server code and the workflow example 
    clone the graphical-lsp repository git clone https://github.com/eclipsesource/graphical-lsp
    cd graphical-lsp
    cd server
    mvn clean verify 
    mkdir ~/.glsp-workflow
    cp example/workflow-example/target/workflow-example-0.0.1-SNAPSHOT-glsp.jar ~/.glsp-workflow
    
## Getting started

    git clone https://github.com/eclipsesource/coffee-editor.git
    cd coffee-editor
    yarn install
    cd browser-app
    yarn start

Open http://localhost:3000 in the browser.

On the `File Menu`, open a project and right click to a JSON file and select `Open With -> Open With Tree Editor`

## Developing with the browser example


1. Start watching changes on the extension via 
   ```
   cd coffee-editor-extension && yarn watch
   ```

   This command starts watching the changes within the extension, e.g. whenever you update any 
   of the source code files within the extension

2. Start watching the browser app via 
   ```
   cd browser-app && yarn watch
   ```

   This command watches for changes within the browser app and rebuils it, e.g. this is the 
   case whenever the coffee-editor-changes finished rebuilding, as the browser has a depedency
   on the extension. Note that rebuilding the browser app might take a couple of seconds. You can
   verify that it finished building the browser-app by looking at the hash of the bundle generated by 
   webpack

3. Start the browser app with 
   ```
   cd browser-app && yarn start
   ```

   This start the browser app on `http://localhost:3000`

**NOTE**: The browser does not reload automatically whenever you changed something, you need to reload yourself currently.


## Publishing coffee-editor-extension

Create a npm user and login to the npm registry, [more on npm publishing](https://docs.npmjs.com/getting-started/publishing-npm-packages).

    npm login

Publish packages with lerna to update versions properly across local packages, [more on publishing with lerna](https://github.com/lerna/lerna#publish).

    npx lerna publish
